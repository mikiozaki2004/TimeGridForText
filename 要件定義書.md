# 要件定義書：空き時間テキスト生成ツール（デスクトップ版）

| 項目 | 内容 |
|---|---|
| プロジェクト名 | TimeGrid Desktop |
| 推奨フォルダ名 | TimeGrid-Desktop |
| 作成日 | 2026/02/16 |
| バージョン | 4.0 (Tauri / Lightweight Edition) |
| 開発技術 | Tauri (Rust + Web Technologies) |

---

## 1. プロジェクト概要

### 1.1 目的
PCでの作業中、チャットツール等で日程調整を求められた際に、アプリを切り替えることなく即座に自分の空き時間を可視化し、テキスト化してクリップボードへ送る。  
「入力の手間」と「PCリソースの消費」を最小限に抑えることを目的とする。

### 1.2 ターゲットユーザー & 利用環境
- **ユーザー**: 日程調整の頻度が高いエンジニア、学生、ビジネスマン
- **環境**: Windows 10/11, macOS, Linux（クロスプラットフォーム）
- **配布形式**: ネイティブインストーラー（.msi / .dmg）または単体実行ファイル（.exe）

---

## 2. 技術スタック (Tech Stack) - 軽量化構成
「圧倒的な軽さ」と「Web技術の再利用」を最優先する構成を採用。

### 2.1 採用技術

#### フレームワーク: Tauri 2.0
**理由**
- **超軽量**: OS標準のWebView（Edge/Safari）を利用するため、Chromiumを同梱するElectronやPythonランタイムを同梱するFletと異なり、インストーラーサイズを **3MB程度** に抑えられる。
- **高速起動**: ネイティブアプリ並みの起動速度（0.5秒以内）を実現。
- **メモリ節約**: 常駐させてもシステムへの負荷が無視できるレベル（20MB〜）。

#### Frontend (UI層): HTML5 / CSS3 / JavaScript (Vanilla)
**理由**
- プロトタイプで作成したコード資産を直接流用できるため。
- 余計なJSフレームワーク（React/Vue等）を使わず、素のJSで記述することで更なる軽量化を図る。

#### Backend (システム層): Rust
**理由**
- Tauriのバックエンド言語。
- 今回はクリップボード操作やウィンドウ制御など、OSごとのAPIを叩く最小限のブリッジとしてのみ機能する（ユーザーがRustコードを大量に書く必要はない）。

---

## 3. 機能要件 (Functional Requirements)

### 3.1 メイン機能

| ID | 機能名 | 詳細 | 実装レイヤー |
|---|---|---|---|
| F-01 | タイムグリッドUI | 1週間分の日付×時間（09:00〜21:00）のグリッド表示。CSS Gridを使用し、レスポンシブかつ軽量に描画する。 | Frontend (CSS/JS) |
| F-02 | ロジック生成 | 選択セルの時間を結合し、テキスト化する。例: `[13, 14] → 13:00〜15:00` | Frontend (JS) |
| F-03 | テンプレート切替 | 「Simple」「Polite」「Business」を`<select>`タグで切り替える。 | Frontend (HTML/JS) |
| F-04 | クリップボードコピー | 生成テキストをOSのクリップボードに転送する。TauriのAPI (`@tauri-apps/plugin-clipboard-manager`) を使用。 | Backend Bridge |
| F-05 | 全クリア | 全ての選択状態（DOMのクラス）を削除し、変数をリセットする。 | Frontend (JS) |

### 3.2 デスクトップ固有機能

| ID | 機能名 | 詳細 | 実装レイヤー |
|---|---|---|---|
| D-01 | 最前面固定 | ウィンドウを常に手前に表示するトグル機能。TauriのWindow API (`setAlwaysOnTop`) を使用。 | Backend Bridge |
| D-02 | 設定の永続化 | ウィンドウ位置・サイズ・テンプレート設定を保存。`localStorage` または `tauri-plugin-store` を使用。 | Frontend/Backend |

---

## 4. UI/UX デザイン設計
Web標準技術（CSS）を用いるため、自由度の高いデザインが可能。

### 4.1 画面構成（400px × 600px 推奨）

- **Title Bar (カスタム)**
  - OS標準のタイトルバーを非表示にし、HTMLで描画したスリムなバーを採用（ドラッグ領域設定）。
  - `[×]` 閉じるボタン
  - `[📌]` 最前面固定トグルボタン

- **Control Panel**
  - テンプレート選択（ドロップダウン）
  - リセットボタン

- **Main Grid**
  - 横スクロール対応のグリッドコンテナ。
  - 選択時はCSSクラス `.selected` を付与し、色（例: `#007AFF`）を変更。

- **Output & Action**
  - テキストエリア（readonly）
  - コピーボタン（画面下部に固定配置、大きく押しやすいデザイン）

---

## 5. データ構造（JavaScript）

### 5.1 状態管理
複雑なステート管理ライブラリは使用せず、シンプルなオブジェクトで管理する。

```js
// 選択状態の管理
let selectedSlots = {
  "2024-02-17": [13, 14, 16],
  "2024-02-18": [10]
};

// 日付データ（動的生成）
let dates = [
  { full: "2024-02-17", display: "2/17(月)" },
  ...
];